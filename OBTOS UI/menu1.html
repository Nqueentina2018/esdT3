<!DOCTYPE html>
<html>
    <head>
        <title>The Ultimate Bubble Tea | Store</title>
        <meta name="description" content="This is the description">
        <link rel="stylesheet" href="styles.css" />
        <script src="store.js" async></script>
    </head>
    <body>
        <header class="main-header">
            <nav class="main-nav nav">
                <ul>
                    <li><a href="menu.html">MENU</a></li>
                    <li><a href="locations.html">STORE OUTLETS</a></li>
                    <li><a href="wallet.html">WALLET</a></li>
                    <li><a href="notifications.html">NOTIFICATIONS</a></li>
                </ul>
            </nav>
            <h1 class="store-name store-name-large">The Ultimate Bubble Tea Store</h1>
        </header>
        <section class="container content-section">
            <!-- <h2 class="section-header">DRINKS</h2> -->
            <div id="main-container" class="container">
                <h1 class="display-4">Drinks</h1>
                <table id="drinksTable" class='table table-striped' border='1'>
                    <thead class='thead-dark'>
                        <tr>
                            <th>Name</th>
                            <th>Price</th>
                        </tr>
                    </thead>
                </table>

            </div>
            <script>
                // Helper function to display error message
                function showError(message) {
                    // Hide the table and button in the event of error
                    $('#drinksTable').hide();
                    
        
                    // Display an error under the main container
                    $('#main-container')
                        .append("<label>" + message + "</label>");
                }
        
                // anonymous async function 
                // - using await requires the function that calls it to be async
                $(async () => {
                    // Change serviceURL to your own
                    var serviceURL = "http://127.0.0.1:5000/menu/drink";
        
                    try {
                        const response =
                            await fetch(
                                serviceURL, { method: 'GET' }
                            );  
                        const data = await response.json();
                        var drinks = data.drinks; //the arr is in data.books of the JSON data
        
                        // array or array.length are falsy
                        if (!drinks || !drinks.length) {
                            showError('drinks list empty or undefined.')
                        } else {
                            // for loop to setup all table rows with obtained book data
                            var rows = "";
                            for (const drink of drinks) {
                                eachRow =
                                    "<td>" + drink.name + "</td>" +
                                    "<td>" + book.price + "</td>";
                                rows += "<tbody><tr>" + eachRow + "</tr></tbody>";
                            }
                            // add all the rows to the table
                            $('#drinksTable').append(rows);
                        }
                    } catch (error) {
                        // Errors when calling the service; such as network error, 
                        // service offline, etc
                        showError
                            ('There is a problem retrieving drinks data, please try again later.<br />' + error);
        
                    } // error
                });
            </script>
            <!-- <div class="shop-items">
                <div class="shop-item">
                    <span class="shop-item-title">Signature Milk Tea</span>
                    <img class="shop-item-image" src="../Images/Signature Milk Tea.jpg">
                    <div class="shop-item-details">
                        <span class="shop-item-price">$2.50</span>
                        <button class="btn btn-primary shop-item-button" type="button">ADD TO CART</button>
                    </div>
                </div>
                <div class="shop-item">
                    <span class="shop-item-title">Brown Sugar Milk Tea</span>
                    <img class="shop-item-image" src="../Images/Brown Sugar Milk Tea.jpg">
                    <div class="shop-item-details">
                        <span class="shop-item-price">$2.90</span>
                        <button class="btn btn-primary shop-item-button"type="button">ADD TO CART</button>
                    </div>
                </div>
                <div class="shop-item">
                    <span class="shop-item-title">Belgian Chocolate Smoothie</span>
                    <img class="shop-item-image" src="../Images/Belgian Chocolate Smoothie.jpg">
                    <div class="shop-item-details">
                        <span class="shop-item-price">$3.90</span>
                        <button class="btn btn-primary shop-item-button" type="button">ADD TO CART</button>
                    </div>
                </div>
                <div class="shop-item">
                    <span class="shop-item-title">Strawberry Cheese Tea</span>
                    <img class="shop-item-image" src="../Images/Strawberry Cheese Tea.jpg">
                    <div class="shop-item-details">
                        <span class="shop-item-price">$4.90</span>
                        <button class="btn btn-primary shop-item-button" type="button">ADD TO CART</button>
                    </div>
                </div>
            </div> -->
        </section>
        <section class="container content-section">
            <h2 class="section-header">TOPPINGS</h2>
            <div class="shop-items">
                <div class="shop-item">
                    <span class="shop-item-title">Pearls</span>
                    <img class="shop-item-image" src="../Images/Pearls.jpg">
                    <div class="shop-item-details">
                        <span class="shop-item-price">$0.60</span>
                        <button class="btn btn-primary shop-item-button" type="button">ADD TO CART</button>
                    </div>
                </div>
                <div class="shop-item">
                    <span class="shop-item-title">Grass Jelly</span>
                    <img class="shop-item-image" src="../Images/Grass Jelly.jpg">
                    <div class="shop-item-details">
                        <span class="shop-item-price">$0.70</span>
                        <button class="btn btn-primary shop-item-button" type="button">ADD TO CART</button>
                    </div>
                </div>
            </div>
        </section>
        <section class="container content-section">
            <h2 class="section-header">CART</h2>
            <div class="cart-row">
                <span class="cart-item cart-header cart-column">ITEM</span>
                <span class="cart-price cart-header cart-column">PRICE</span>
                <span class="cart-quantity cart-header cart-column">QUANTITY</span>
            </div>
            <div class="cart-items">
            </div>
            <div class="cart-total">
                <strong class="cart-total-title">Total</strong>
                <span class="cart-total-price">$0</span>
            </div>
            <button class="btn btn-primary btn-purchase" type="button">PURCHASE</button>
        </section>
        
    </body>
</html>